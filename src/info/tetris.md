# Tetris Game

## Описание программы
Это реализация классической игры Tetris на языке C. Программа использует массивы для представления игрового поля и фигур (тетромино), а также имеет базовую логику управления игровым процессом, включая перемещение фигур, проверку столкновений, ротацию фигур, подсчет очков и уровней.

## Структура кода

### Основные структуры
- **GameInfo_t** — структура, представляющая состояние игры, включает:
  - `field`: игровое поле (массив)
  - `next`: следующая фигура
  - `score`: текущий счет
  - `level`: текущий уровень
  - `pause`: состояние паузы (0 - игра, 1 - пауза, 2 - завершение)
  - `speed`: текущая скорость игры

- **Figure_t** — структура, представляющая активную фигуру на поле, включает:
  - `figureArr`: массив, представляющий форму фигуры
  - `cordX`: X-координата текущего положения фигуры
  - `cordY`: Y-координата текущего положения фигуры
  - `type`: тип текущей фигуры
  - `nextType`: тип следующей фигуры

- **UserAction_t** — перечисление возможных действий игрока:
  - `Pause`, `Left`, `Right`, `Down`, `Action`, `Terminate`, `Start`

### Основные функции

- **Инициализация:**
  - `initializeField(GameInfo_t *game)`: инициализирует игровое поле и память для фигур.
  - `spawnFirstFig(Figure_t *figure, GameInfo_t *game)`: создает первую активную фигуру и следующую фигуру.
  
- **Игровой процесс:**
  - `movePieceDown(Figure_t *figure, GameInfo_t *game)`: перемещает фигуру вниз по игровому полю.
  - `canMoveDown(Figure_t *figure, GameInfo_t *game)`: проверяет, может ли фигура двигаться вниз.
  - `rotateFigure(Figure_t *figure, GameInfo_t *game)`: вращает активную фигуру, если это возможно.
  - `checkRow(GameInfo_t *game)`: проверяет заполненные ряды и удаляет их, обновляя счет.
  - `fallTime(struct timeval *lastFallTime, struct timeval *currentTime, GameInfo_t *game, Figure_t *figure)`: управляет временем падения фигур в зависимости от скорости игры.
  
- **Управление пользователем:**
  - `userInput(GameInfo_t *game, Figure_t *figure, UserAction_t action)`: обрабатывает действия пользователя, такие как перемещение, поворот или пауза.

- **Сохранение и загрузка данных:**
  - `writeHighScore(int hscore)`: записывает рекордный счет в файл.
  - `readHighScore(int *hscore)`: считывает рекордный счет из файла.

## Управление

### Управляющие действия пользователя:
- **Pause**: приостанавливает или возобновляет игру. 'p'
- **Left**: перемещает фигуру влево. 'стрелка влево'
- **Right**: перемещает фигуру вправо. 'стрелка вправо'
- **Down**: ускоряет падение фигуры.  'стрелка вниз'
- **Action**: поворот фигуры. 'z'
- **Start**: начинает игру 's'.
- **Terminate**: завершает игру 'q'.

## Состояния игры
- **Playing**: активное состояние игры.
- **Paused**: состояние паузы.
- **Terminated**: завершение игры.

## Алгоритмы

### Проверка рядов
Алгоритм проверки заполненности рядов (`checkRow`) проходит по каждому ряду снизу вверх и проверяет, заполнены ли все ячейки. Если ряд полностью заполнен, он удаляется, а над ним перемещаются все ряды. При успешной очистке ряда, игра увеличивает счет и уровень.

### Спавн новых фигур
Функция `spawnNewPiece` копирует следующую фигуру в активную и создает новую случайную фигуру для следующего спавна.

## Файлы

- **hscore.txt**: файл для хранения рекордов игры.